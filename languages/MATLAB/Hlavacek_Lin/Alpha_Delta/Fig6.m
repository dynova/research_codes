fig = figure('Position', get(0, 'Screensize'));
tiledlayout(4,2,"TileSpacing","compact");

fs = 24;

x = readNPY('inferences/Dallas4-n5-parLog.npy');
y = readNPY('inferences/Dallas4-n5-logLLog.npy');
[aa,bb] = max(y);
disp(x(bb,19));
disp(x(bb,20));
nexttile;
hold all;
h1 = histogram(x(220001:340001,19),30,'Normalization','pdf','EdgeColor','none','FaceColor','#355E3B');
h2 = histogram(x(220001:340001,20),30,'Normalization','pdf','EdgeColor','none','FaceColor','#0BDA51');
xlim([1.0 2.5]);
xticks(1.0:0.5:2.5);
xtickformat('%.1f');
yticks([]);
ylabel('Density');
ax = gca;
set(ax,'TickDir','out','FontSize',fs,'FontWeight','bold');
hold off;

x = readNPY('inferences/Dallas4-n5-parLog.npy');
nexttile;
hold all;
h1 = histogram(x(220001:340001,17),30,'Normalization','pdf','EdgeColor','none','FaceColor','#355E3B');
h2 = histogram(x(220001:340001,17)+x(220001:340001,18),30,'Normalization','pdf','EdgeColor','none','FaceColor','#0BDA51');
xlim([376 523]);
xticks(376:49:523);
xticklabels({'01-31-21'   '03-21-21'   '05-09-21'   '06-27-21'});
yticks([]);
ylabel('Density');
ax = gca;
set(ax,'TickDir','out','FontSize',fs,'FontWeight','bold');
title('Dallas','FontSize',fs);
ax.TitleHorizontalAlignment = 'right';
legend([h1,h2],{'02-01-21 (01-31-21, 02-01-21)', '06-02-21 (06-02-21, 06-03-21)'},'Location','north','box','off');
hold off;

x = readNPY('inferences/Houston2-n4-parLog.npy');
y = readNPY('inferences/Houston2-n4-logLLog.npy');
[aa,bb] = max(y);
disp(x(bb,16));
disp(x(bb,17));
nexttile;
hold all;
h1 = histogram(x(200001:380001,16),30,'Normalization','pdf','EdgeColor','none','FaceColor','#355E3B');
h2 = histogram(x(200001:380001,17),30,'Normalization','pdf','EdgeColor','none','FaceColor','#0BDA51');
xlim([1.0 2.5]);
xticks(1.0:0.5:2.5);
xtickformat('%.1f');
yticks([]);
ylabel('Density');
ax = gca;
set(ax,'TickDir','out','FontSize',fs,'FontWeight','bold');
hold off;

x = readNPY('inferences/Houston2-n4-parLog.npy');
nexttile;
hold all;
h1 = histogram(x(200001:380001,14),30,'Normalization','pdf','EdgeColor','none','FaceColor','#355E3B');
h2 = histogram(x(200001:380001,14)+x(200001:380001,15),30,'Normalization','pdf','EdgeColor','none','FaceColor','#0BDA51');
xlim([376 523]);
xticks(376:49:523);
xticklabels({'01-31-21'   '03-21-21'   '05-09-21'   '06-27-21'});
yticks([]);
ylabel('Density');
ax = gca;
set(ax,'TickDir','out','FontSize',fs,'FontWeight','bold');
title('Houston','FontSize',fs);
ax.TitleHorizontalAlignment = 'right';
legend([h1,h2],{'02-24-21 (02-24-21, 02-24-21)', '06-26-21 (06-25-21, 06-26-21)'},'Location','north','box','off');
hold off;

x = readNPY('inferences/NYC0-n4-parLog.npy');
y = readNPY('inferences/NYC0-n4-logLLog.npy');
[aa,bb] = max(y);
disp(x(bb,16));
disp(x(bb,17));
nexttile;
hold all
h1 = histogram(x(12000:36000,16),10,'Normalization','pdf','EdgeColor','none','FaceColor','#355E3B');
h2 = histogram(x(12000:36000,17),10,'Normalization','pdf','EdgeColor','none','FaceColor','#0BDA51');
xlim([1.0 2.5]);
xticks(1.0:0.5:2.5);
xtickformat('%.1f');
yticks([]);
ylabel('Density');
ax = gca;
set(ax,'TickDir','out','FontSize',fs,'FontWeight','bold');
hold off;

x = readNPY('inferences/NYC0-n4-parLog.npy');
nexttile;
hold all
h1 = histogram(x(12000:36000,14),10,'Normalization','pdf','EdgeColor','none','FaceColor','#355E3B');
h2 = histogram(x(12000:36000,14)+x(12000:36000,15),10,'Normalization','pdf','EdgeColor','none','FaceColor','#0BDA51');
xlim([376 523]);
xticks(376:49:523);
xticklabels({'01-31-21'   '03-21-21'   '05-09-21'   '06-27-21'});
yticks([]);
ylabel('Density');
ax = gca;
set(ax,'TickDir','out','FontSize',fs,'FontWeight','bold');
title('New York City','FontSize',fs);
ax.TitleHorizontalAlignment = 'right';
legend([h1,h2],{'02-04-21 (02-04-21, 02-05-21)', '06-16-21 (06-16-21, 06-16-21)'},'Location','north','box','off');
hold off;

x = readNPY('inferences/Phoenix29-n5-parLog.npy');
y = readNPY('inferences/Phoenix29-n5-logLLog.npy');
[aa,bb] = max(y);
disp(x(bb,19));
disp(x(bb,20));
nexttile;
hold all;
h1 = histogram(x(76000:90000,19),10,'Normalization','pdf','EdgeColor','none','FaceColor','#355E3B');
h2 = histogram(x(76000:90000,20),10,'Normalization','pdf','EdgeColor','none','FaceColor','#0BDA51');
xlim([1.0 2.5]);
xticks(1.0:0.5:2.5);
xtickformat('%.1f');
yticks([]);
ylabel('Density');
ax = gca;
set(ax,'TickDir','out','FontSize',fs,'FontWeight','bold');
xlabel('Relative transmissibility of Alpha and Delta');
hold off;

x = readNPY('inferences/Phoenix29-n5-parLog.npy');
nexttile;
hold all;
h1 = histogram(x(1:100000,17),10,'Normalization','pdf','EdgeColor','none','FaceColor','#355E3B');
h2 = histogram(x(1:100000,17)+x(1:100000,18),10,'Normalization','pdf','EdgeColor','none','FaceColor','#0BDA51');
xlim([376 523]);
xticks(376:49:523);
xticklabels({'01-31-21'   '03-21-21'   '05-09-21'   '06-27-21'});
yticks([]);
ylabel('Density');
ax = gca;
set(ax,'TickDir','out','FontSize',fs,'FontWeight','bold');
title('Phoenix','FontSize',fs);
ax.TitleHorizontalAlignment = 'right';
legend([h1,h2],{'02-28-21 (02-28-21, 02-28-21)', '06-26-21 (06-26-21, 06-27-21)'},'Location','north','box','off');
xlabel('Alpha and Delta takeoff times');
hold off;

exportgraphics(fig,'Fig6_MATLAB.pdf','BackgroundColor','white','ContentType','vector');