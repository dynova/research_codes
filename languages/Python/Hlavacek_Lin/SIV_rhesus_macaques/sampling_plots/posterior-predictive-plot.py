import numpy as np
from matplotlib import cm
import matplotlib
import matplotlib.pyplot as plt
plt.rcParams.update({'font.size':10})
colors = cm.viridis(np.linspace(0,1,12))

p1l68 = np.load('p1l68.npy')
p1l95 = np.load('p1l95.npy')
p1u68 = np.load('p1u68.npy')
p1u95 = np.load('p1u95.npy')
p2l68 = np.load('p2l68.npy')
p2l95 = np.load('p2l95.npy')
p2u68 = np.load('p2u68.npy')
p2u95 = np.load('p2u95.npy')
p3l68 = np.load('p3l68.npy')
p3l95 = np.load('p3l95.npy')
p3u68 = np.load('p3u68.npy')
p3u95 = np.load('p3u95.npy')
p4l68 = np.load('p4l68.npy')
p4l95 = np.load('p4l95.npy')
p4u68 = np.load('p4u68.npy')
p4u95 = np.load('p4u95.npy')
p5l68 = np.load('p5l68.npy')
p5l95 = np.load('p5l95.npy')
p5u68 = np.load('p5u68.npy')
p5u95 = np.load('p5u95.npy')
p6l68 = np.load('p6l68.npy')
p6l95 = np.load('p6l95.npy')
p6u68 = np.load('p6u68.npy')
p6u95 = np.load('p6u95.npy')
p7l68 = np.load('p7l68.npy')
p7l95 = np.load('p7l95.npy')
p7u68 = np.load('p7u68.npy')
p7u95 = np.load('p7u95.npy')
p8l68 = np.load('p8l68.npy')
p8l95 = np.load('p8l95.npy')
p8u68 = np.load('p8u68.npy')
p8u95 = np.load('p8u95.npy')
p9l68 = np.load('p9l68.npy')
p9l95 = np.load('p9l95.npy')
p9u68 = np.load('p9u68.npy')
p9u95 = np.load('p9u95.npy')
p10l68 = np.load('p10l68.npy')
p10l95 = np.load('p10l95.npy')
p10u68 = np.load('p10u68.npy')
p10u95 = np.load('p10u95.npy')
p1_median = np.load('p1_median.npy')
p2_median = np.load('p2_median.npy')
p3_median = np.load('p3_median.npy')
p4_median = np.load('p4_median.npy')
p5_median = np.load('p5_median.npy')
p6_median = np.load('p6_median.npy')
p7_median = np.load('p7_median.npy')
p8_median = np.load('p8_median.npy')
p9_median = np.load('p9_median.npy')
p10_median = np.load('p10_median.npy')

fig = plt.figure()
ax = [plt.subplot(1,1,1)]
xdata = [70,140,210,280,350,420,490,560]
ydata = [5.873,7.272,6.652,6.538,6.199,5.880,5.920,6.084]
ax[0].scatter(xdata,ydata,zorder=4,label='data')
ax[0].set_xlim([0,560])
ax[0].set_ylim([0,10])
ax[0].set_xticks([0,70,140,210,280,350,420,490,560])
ax[0].set_xticklabels([0,7,14,21,28,35,42,49,56])
ax[0].plot(p1_median,color = colors[0], zorder = 3, label = 'Median')
ax[0].fill_between(np.linspace(0,560,561),p1l68,p1u68, facecolor = colors[10], zorder = 2, label = '68% posterior')
ax[0].fill_between(np.linspace(0,560,561),p1l95,p1u95, facecolor = colors[5], zorder = 1, label = '95% posterior')
ax[0].set_xlabel('Time p.i. (d)')
ax[0].set_ylabel(r'$\log_{10}$ (plasma viral load) [vRNA/mL]')
ax[0].set_title('Control animals (Phase I)')
fig.tight_layout()
fig.legend(loc = (0.75,0.76), frameon=False, fontsize=7.0)
fig.savefig('p1.pdf',dpi=1200)

fig = plt.figure()
ax = [plt.subplot(1,1,1)]
xdata = [70,140,210,280,350,420,490,560]
ydata = [-1, -1, -1, -1, -1, -1, -1, 1.951]
ax[0].scatter(xdata,ydata,zorder=4,label='data')
ax[0].set_xlim([0,560])
ax[0].set_ylim([0,6])
ax[0].set_xticks([0,70,140,210,280,350,420,490,560])
ax[0].set_xticklabels([0,7,14,21,28,35,42,49,56])
ax[0].plot(p2_median,color = colors[0], zorder = 3, label = 'Median')
ax[0].fill_between(np.linspace(0,560,561),p2l68,p2u68, facecolor = colors[10], zorder = 2, label = '68% posterior')
ax[0].fill_between(np.linspace(0,560,561),p2l95,p2u95, facecolor = colors[5], zorder = 1, label = '95% posterior')
ax[0].set_xlabel('Time p.i. (d)')
ax[0].set_ylabel(r'$\log_{10}$ (Number of infected cells per 100,000)')
ax[0].set_title('Control animals (Phase I)')
fig.tight_layout()
fig.legend(loc = (0.75,0.76), frameon=False, fontsize=7.0)
fig.savefig('p2.pdf',dpi=1200)

fig = plt.figure()
ax = [plt.subplot(1,1,1)]
xdata = [70,140,210,280,350,420,490,560]
ydata = [-1, -1, -1, -1, -1, -1, -1, 10.78]
ax[0].scatter(xdata,ydata,zorder=4,label='data')
ax[0].set_xlim([0,560])
ax[0].set_ylim([7,15])
ax[0].set_xticks([0,70,140,210,280,350,420,490,560])
ax[0].set_xticklabels([0,7,14,21,28,35,42,49,56])
ax[0].plot(p3_median,color = colors[0], zorder = 3, label = 'Median')
ax[0].fill_between(np.linspace(0,560,561),p3l68,p3u68, facecolor = colors[10], zorder = 2, label = '68% posterior')
ax[0].fill_between(np.linspace(0,560,561),p3l95,p3u95, facecolor = colors[5], zorder = 1, label = '95% posterior')
ax[0].set_xlabel('Time p.i. (d)')
ax[0].set_ylabel(r'$\log_{10}$ (Number of FDC-associated virions)')
ax[0].set_title('Control animals (Phase I)')
fig.tight_layout()
fig.legend(loc = (0.75,0.76), frameon=False, fontsize=7.0)
fig.savefig('p3.pdf',dpi=1200)

fig = plt.figure()
ax = [plt.subplot(1,1,1)]
xdata = [70,140,210,280,350,420,490,560]
ydata = [5.844,7.549,6.704,6.458,6.103,5.383,5.822,5.781]
ax[0].scatter(xdata,ydata,zorder=4,label='data')
ax[0].set_xlim([0,560])
ax[0].set_ylim([0,10])
ax[0].set_xticks([0,70,140,210,280,350,420,490,560])
ax[0].set_xticklabels([0,7,14,21,28,35,42,49,56])
ax[0].plot(p4_median,color = colors[0], zorder = 3, label = 'Median')
ax[0].fill_between(np.linspace(0,560,561),p4l68,p4u68, facecolor = colors[10], zorder = 2, label = '68% posterior')
ax[0].fill_between(np.linspace(0,560,561),p4l95,p4u95, facecolor = colors[5], zorder = 1, label = '95% posterior')
ax[0].set_xlabel('Time p.i. (d)')
ax[0].set_ylabel(r'$\log_{10}$ (plasma viral load) [vRNA/mL]')
ax[0].set_title('Treated animals (Phase I)')
fig.tight_layout()
fig.legend(loc = (0.75,0.76), frameon=False, fontsize=7.0)
fig.savefig('p4.pdf',dpi=1200)

fig = plt.figure()
ax = [plt.subplot(1,1,1)]
xdata = [70,140,210,280,350,420,490,560]
ydata = [-1, -1, -1, -1, -1, -1, -1, 1.592]
ax[0].scatter(xdata,ydata,zorder=4,label='data')
ax[0].set_xlim([0,560])
ax[0].set_ylim([0,6])
ax[0].set_xticks([0,70,140,210,280,350,420,490,560])
ax[0].set_xticklabels([0,7,14,21,28,35,42,49,56])
ax[0].plot(p5_median,color = colors[0], zorder = 3, label = 'Median')
ax[0].fill_between(np.linspace(0,560,561),p5l68,p5u68, facecolor = colors[10], zorder = 2, label = '68% posterior')
ax[0].fill_between(np.linspace(0,560,561),p5l95,p5u95, facecolor = colors[5], zorder = 1, label = '95% posterior')
ax[0].set_xlabel('Time p.i. (d)')
ax[0].set_ylabel(r'$\log_{10}$ (Number of infected cells per 100,000)')
ax[0].set_title('Treated animals (Phase I)')
fig.tight_layout()
fig.legend(loc = (0.75,0.76), frameon=False, fontsize=7.0)
fig.savefig('p5.pdf',dpi=1200)

fig = plt.figure()
ax = [plt.subplot(1,1,1)]
xdata = [70,140,210,280,350,420,490,560]
ydata = [-1, -1, -1, -1, -1, -1, -1, 9.673]
ax[0].scatter(xdata,ydata,zorder=4,label='data')
ax[0].set_xlim([0,560])
ax[0].set_ylim([7,15])
ax[0].set_xticks([0,70,140,210,280,350,420,490,560])
ax[0].set_xticklabels([0,7,14,21,28,35,42,49,56])
ax[0].plot(p6_median,color = colors[0], zorder = 3, label = 'Median')
ax[0].fill_between(np.linspace(0,560,561),p6l68,p6u68, facecolor = colors[10], zorder = 2, label = '68% posterior')
ax[0].fill_between(np.linspace(0,560,561),p6l95,p6u95, facecolor = colors[5], zorder = 1, label = '95% posterior')
ax[0].set_xlabel('Time p.i. (d)')
ax[0].set_ylabel(r'$\log_{10}$ (Number of FDC-associated virions)')
ax[0].set_title('Treated animals (Phase I)')
fig.tight_layout()
fig.legend(loc = (0.75,0.76), frameon=False, fontsize=7.0)
fig.savefig('p6.pdf',dpi=1200)

fig = plt.figure()
ax = [plt.subplot(1,1,1)]
xdata = [70,140,210,280,350,420,430,450,490,560,630,700,770,840]
ydata = [5.712,7.154,6.354,6.162,5.693,5.915,5.687,4.874,3.992,3.237,3.297,3.148,2.807,2.402]
ax[0].scatter(xdata,ydata,zorder=4,label='data')
ax[0].set_xlim([0,840])
ax[0].set_ylim([0,10])
ax[0].set_xticks([0,140,280,420,560,700,840])
ax[0].set_xticklabels([0,14,28,42,56,70,84])
ax[0].plot(p7_median,color = colors[0], zorder = 3, label = 'Median')
ax[0].fill_between(np.linspace(0,880,881),p7l68,p7u68, facecolor = colors[10], zorder = 2, label = '68% posterior')
ax[0].fill_between(np.linspace(0,880,881),p7l95,p7u95, facecolor = colors[5], zorder = 1, label = '95% posterior')
ax[0].set_xlabel('Time p.i. (d)')
ax[0].set_ylabel(r'$\log_{10}$ (plasma viral load) [vRNA/mL]')
ax[0].set_title('Control animals (Phase II)')
fig.tight_layout()
fig.legend(loc = (0.75,0.76), frameon=False, fontsize=7.0)
fig.savefig('p7.pdf',dpi=1200)

fig = plt.figure()
ax = [plt.subplot(1,1,1)]
xdata = [70,140,210,280,350,420,430,450,490,560,630,700,770,840]
ydata = [-1,-1,-1,-1,-1,4.299,-1,-1,4.120,3.604,-1,3.091,-1,2.541]
ax[0].scatter(xdata,ydata,zorder=4,label='data')
ax[0].set_xlim([0,840])
ax[0].set_ylim([0,9])
ax[0].set_xticks([0,140,280,420,560,700,840])
ax[0].set_xticklabels([0,14,28,42,56,70,84])
ax[0].plot(p8_median,color = colors[0], zorder = 3, label = 'Median')
ax[0].fill_between(np.linspace(0,880,881),p8l68,p8u68, facecolor = colors[10], zorder = 2, label = '68% posterior')
ax[0].fill_between(np.linspace(0,880,881),p8l95,p8u95, facecolor = colors[5], zorder = 1, label = '95% posterior')
ax[0].set_xlabel('Time p.i. (d)')
ax[0].set_ylabel(r'$\log_{10}$ (surface density of FDC-associated virions) [virions/mm$^2$]')
ax[0].set_title('Control animals (Phase II)')
fig.tight_layout()
fig.legend(loc = (0.75,0.76), frameon=False, fontsize=7.0)
fig.savefig('p8.pdf',dpi=1200)

fig = plt.figure()
ax = [plt.subplot(1,1,1)]
xdata = [70,140,210,280,350,420,430,450,490,560,630,700,770,840]
ydata = [5.446,7.175,6.424,6.168,5.726,5.884,5.659,4.938,4.124,3.546,3.346,3.188,2.954,2.460]
ax[0].scatter(xdata,ydata,zorder=4,label='data')
ax[0].set_xlim([0,840])
ax[0].set_ylim([0,10])
ax[0].set_xticks([0,140,280,420,560,700,840])
ax[0].set_xticklabels([0,14,28,42,56,70,84])
ax[0].plot(p9_median,color = colors[0], zorder = 3, label = 'Median')
ax[0].fill_between(np.linspace(0,880,881),p9l68,p9u68, facecolor = colors[10], zorder = 2, label = '68% posterior')
ax[0].fill_between(np.linspace(0,880,881),p9l95,p9u95, facecolor = colors[5], zorder = 1, label = '95% posterior')
ax[0].set_xlabel('Time p.i. (d)')
ax[0].set_ylabel(r'$\log_{10}$ (plasma viral load) [vRNA/mL]')
ax[0].set_title('Treated animals (Phase II)')
fig.tight_layout()
fig.legend(loc = (0.75,0.76), frameon=False, fontsize=7.0)
fig.savefig('p9.pdf',dpi=1200)

fig = plt.figure()
ax = [plt.subplot(1,1,1)]
xdata = [70,140,210,280,350,420,430,450,490,560,630,700,770,840]
ydata = [-1,-1,-1,-1,-1,4.240,-1,-1,3.948,3.368,-1,2.680,-1,1.758]
ax[0].scatter(xdata,ydata,zorder=4,label='data')
ax[0].set_xlim([0,840])
ax[0].set_ylim([0,9])
ax[0].set_xticks([0,140,280,420,560,700,840])
ax[0].set_xticklabels([0,14,28,42,56,70,84])
ax[0].plot(p10_median,color = colors[0], zorder = 3, label = 'Median')
ax[0].fill_between(np.linspace(0,880,881),p10l68,p10u68, facecolor = colors[10], zorder = 2, label = '68% posterior')
ax[0].fill_between(np.linspace(0,880,881),p10l95,p10u95, facecolor = colors[5], zorder = 1, label = '95% posterior')
ax[0].set_xlabel('Time p.i. (d)')
ax[0].set_ylabel(r'$\log_{10}$ (surface density of FDC-associated virions) [virions/mm$^2$]')
ax[0].set_title('Treated animals (Phase II)')
fig.tight_layout()
fig.legend(loc = (0.75,0.76), frameon=False, fontsize=7.0)
fig.savefig('p10.pdf',dpi=1200)