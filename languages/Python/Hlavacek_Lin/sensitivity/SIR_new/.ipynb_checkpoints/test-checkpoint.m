opts = delimitedTextImportOptions("NumVariables", 135);
opts.DataLines = [2, Inf];
opts.Delimiter = ",";
opts.VariableNames = ["state", "date", "critical_staffing_shortage_today_yes", "critical_staffing_shortage_today_no", "critical_staffing_shortage_today_not_reported", "critical_staffing_shortage_anticipated_within_week_yes", "critical_staffing_shortage_anticipated_within_week_no", "critical_staffing_shortage_anticipated_within_week_not_reported", "hospital_onset_covid", "hospital_onset_covid_coverage", "inpatient_beds", "inpatient_beds_coverage", "inpatient_beds_used", "inpatient_beds_used_coverage", "inpatient_beds_used_covid", "inpatient_beds_used_covid_coverage", "previous_day_admission_adult_covid_confirmed", "previous_day_admission_adult_covid_confirmed_coverage", "previous_day_admission_adult_covid_suspected", "previous_day_admission_adult_covid_suspected_coverage", "previous_day_admission_pediatric_covid_confirmed", "previous_day_admission_pediatric_covid_confirmed_coverage", "previous_day_admission_pediatric_covid_suspected", "previous_day_admission_pediatric_covid_suspected_coverage", "staffed_adult_icu_bed_occupancy", "staffed_adult_icu_bed_occupancy_coverage", "staffed_icu_adult_patients_confirmed_and_suspected_covid", "staffed_icu_adult_patients_confirmed_and_suspected_covid_covera", "staffed_icu_adult_patients_confirmed_covid", "staffed_icu_adult_patients_confirmed_covid_coverage", "total_adult_patients_hospitalized_confirmed_and_suspected_covid", "total_adult_patients_hospitalized_confirmed_and_suspected_covi1", "total_adult_patients_hospitalized_confirmed_covid", "total_adult_patients_hospitalized_confirmed_covid_coverage", "total_pediatric_patients_hospitalized_confirmed_and_suspected_c", "total_pediatric_patients_hospitalized_confirmed_and_suspected_1", "total_pediatric_patients_hospitalized_confirmed_covid", "total_pediatric_patients_hospitalized_confirmed_covid_coverage", "total_staffed_adult_icu_beds", "total_staffed_adult_icu_beds_coverage", "inpatient_beds_utilization", "inpatient_beds_utilization_coverage", "inpatient_beds_utilization_numerator", "inpatient_beds_utilization_denominator", "percent_of_inpatients_with_covid", "percent_of_inpatients_with_covid_coverage", "percent_of_inpatients_with_covid_numerator", "percent_of_inpatients_with_covid_denominator", "inpatient_bed_covid_utilization", "inpatient_bed_covid_utilization_coverage", "inpatient_bed_covid_utilization_numerator", "inpatient_bed_covid_utilization_denominator", "adult_icu_bed_covid_utilization", "adult_icu_bed_covid_utilization_coverage", "adult_icu_bed_covid_utilization_numerator", "adult_icu_bed_covid_utilization_denominator", "adult_icu_bed_utilization", "adult_icu_bed_utilization_coverage", "adult_icu_bed_utilization_numerator", "adult_icu_bed_utilization_denominator", "geocoded_state", "previous_day_admission_adult_covid_confirmed_1819", "previous_day_admission_adult_covid_confirmed_1819_coverage", "previous_day_admission_adult_covid_confirmed_2029", "previous_day_admission_adult_covid_confirmed_2029_coverage", "previous_day_admission_adult_covid_confirmed_3039", "previous_day_admission_adult_covid_confirmed_3039_coverage", "previous_day_admission_adult_covid_confirmed_4049", "previous_day_admission_adult_covid_confirmed_4049_coverage", "previous_day_admission_adult_covid_confirmed_5059", "previous_day_admission_adult_covid_confirmed_5059_coverage", "previous_day_admission_adult_covid_confirmed_6069", "previous_day_admission_adult_covid_confirmed_6069_coverage", "previous_day_admission_adult_covid_confirmed_7079", "previous_day_admission_adult_covid_confirmed_7079_coverage", "previous_day_admission_adult_covid_confirmed_80", "previous_day_admission_adult_covid_confirmed_80_coverage", "previous_day_admission_adult_covid_confirmed_unknown", "previous_day_admission_adult_covid_confirmed_unknown_coverage", "previous_day_admission_adult_covid_suspected_1819", "previous_day_admission_adult_covid_suspected_1819_coverage", "previous_day_admission_adult_covid_suspected_2029", "previous_day_admission_adult_covid_suspected_2029_coverage", "previous_day_admission_adult_covid_suspected_3039", "previous_day_admission_adult_covid_suspected_3039_coverage", "previous_day_admission_adult_covid_suspected_4049", "previous_day_admission_adult_covid_suspected_4049_coverage", "previous_day_admission_adult_covid_suspected_5059", "previous_day_admission_adult_covid_suspected_5059_coverage", "previous_day_admission_adult_covid_suspected_6069", "previous_day_admission_adult_covid_suspected_6069_coverage", "previous_day_admission_adult_covid_suspected_7079", "previous_day_admission_adult_covid_suspected_7079_coverage", "previous_day_admission_adult_covid_suspected_80", "previous_day_admission_adult_covid_suspected_80_coverage", "previous_day_admission_adult_covid_suspected_unknown", "previous_day_admission_adult_covid_suspected_unknown_coverage", "deaths_covid", "deaths_covid_coverage", "on_hand_supply_therapeutic_a_casirivimab_imdevimab_courses", "on_hand_supply_therapeutic_b_bamlanivimab_courses", "on_hand_supply_therapeutic_c_bamlanivimab_etesevimab_courses", "previous_week_therapeutic_a_casirivimab_imdevimab_courses_used", "previous_week_therapeutic_b_bamlanivimab_courses_used", "previous_week_therapeutic_c_bamlanivimab_etesevimab_courses_use", "icu_patients_confirmed_influenza", "icu_patients_confirmed_influenza_coverage", "previous_day_admission_influenza_confirmed", "previous_day_admission_influenza_confirmed_coverage", "previous_day_deaths_covid_and_influenza", "previous_day_deaths_covid_and_influenza_coverage", "previous_day_deaths_influenza", "previous_day_deaths_influenza_coverage", "total_patients_hospitalized_confirmed_influenza", "total_patients_hospitalized_confirmed_influenza_and_covid", "total_patients_hospitalized_confirmed_influenza_and_covid_cover", "total_patients_hospitalized_confirmed_influenza_coverage", "all_pediatric_inpatient_bed_occupied", "all_pediatric_inpatient_bed_occupied_coverage", "all_pediatric_inpatient_beds", "all_pediatric_inpatient_beds_coverage", "previous_day_admission_pediatric_covid_confirmed_0_4", "previous_day_admission_pediatric_covid_confirmed_0_4_coverage", "previous_day_admission_pediatric_covid_confirmed_12_17", "previous_day_admission_pediatric_covid_confirmed_12_17_coverage", "previous_day_admission_pediatric_covid_confirmed_5_11", "previous_day_admission_pediatric_covid_confirmed_5_11_coverage", "previous_day_admission_pediatric_covid_confirmed_unknown", "previous_day_admission_pediatric_covid_confirmed_unknown_covera", "staffed_icu_pediatric_patients_confirmed_covid", "staffed_icu_pediatric_patients_confirmed_covid_coverage", "staffed_pediatric_icu_bed_occupancy", "staffed_pediatric_icu_bed_occupancy_coverage", "total_staffed_pediatric_icu_beds", "total_staffed_pediatric_icu_beds_coverage"];
opts.VariableTypes = ["categorical", "string", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "string", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double"];
opts.ExtraColumnsRule = "ignore";
opts.EmptyLineRule = "read";
opts = setvaropts(opts, ["date", "geocoded_state"], "WhitespaceRule", "preserve");
opts = setvaropts(opts, ["state", "date", "geocoded_state"], "EmptyFieldRule", "auto");
data = sortrows(readtable("/Users/amallela/Documents/sensitivity/SIR_new/data.csv", opts),2);
clear opts;
v1 = find(data.date == "2022/09/01");
v2 = find(data.date == "2023/04/30");
data = data(v1(1):v2(end),[1,2,108]);
data = data(data.state == "NV", :);